Исполнение из Электронного Бюджета
<mat-vertical-stepper [linear]="isLinear" #stepper xmlns:padding-left="http://www.w3.org/1999/xhtml">
  <mat-step [stepControl]="zeroFormGroup">
    <form [formGroup]="zeroFormGroup">
      <ng-template matStepLabel>Загрузите файл</ng-template>
      <div style="padding-bottom: 20px">
        <button mat-raised-button type="button" (click)="fileInput.click()">
          Выберите файл
          <input #fileInput type="file" style="display: none" accept=".xml" [multiple]="false" (change)="filesChanged($event)"/>
        </button>
        <span class="file-input-text" style="padding-left: 25px">{{ selectedFileText }}</span>
      </div>
      <div>
        <button
          mat-raised-button matStepperNext type="button" color = "primary"
          class="file-input-button" (click) = "startProcessFile()" [disabled]="disabledStartButton">
          Начать загрузку
        </button>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="firstFormGroup">
    <form [formGroup]="firstFormGroup">
      <ng-template matStepLabel>Сопоставление загружаемого результата и мероприятия из ИСУПа</ng-template>
      <div style="padding-bottom: 20px">
        <mat-radio-group class="radio-group" *ngIf="!workPackageIsMatched">
          <mat-radio-button class="radio-button" value="1" (change)="projectRadioChange($event)" [checked]="selectProjectVisible">Выбрать существующий проект</mat-radio-button>
          <mat-radio-button class="radio-button" value="2" (change)="projectRadioChange($event)">Создать новый проект</mat-radio-button>
        </mat-radio-group>
        <op-project-modal-selector [selectedProject]="selectedProject" (outputSelectedProject)="getOutputProject($event)" #projectModalSelectorComponent [hidden]="!selectProjectVisible"></op-project-modal-selector>
        <mat-form-field *ngIf="!selectProjectVisible" class="new-input-width">
          <mat-label>Название нового проекта</mat-label>
          <input matInput (change)="setNewProjectName($event.target)">
        </mat-form-field>
      </div>
      <div>
        <mat-radio-group class="radio-group"  *ngIf="workPackageMatRadioGroupVisible && !workPackageIsMatched">
          <mat-radio-button class="radio-button" value="1" (change)="workPackageRadioChange($event)" [checked]="selectWorkPackageVisible">Выбрать существующее мероприятие</mat-radio-button>
          <mat-radio-button class="radio-button" value="2" (change)="workPackageRadioChange($event)" [checked]="!selectWorkPackageVisible">Создать новое мероприятие</mat-radio-button>
        </mat-radio-group>
        <op-work-package-modal-selector [selectedWorkPackage]="selectedWorkPackage" [hidden]="!selectWorkPackageVisible" #workPackageModalSelectorComponent (outputSelectedWorkPackage)="getOutputWorkPackage($event)"></op-work-package-modal-selector>
        <mat-form-field *ngIf="!selectWorkPackageVisible" class="new-input-width">
          <mat-label>Название результата</mat-label>
          <input matInput (change)="setNewWorkPackageName($event.target)">
        </mat-form-field>
      </div>
      <div>
        <op-organization-modal-selector [selectedOrganization]="selectedOrganization"
                                         #organizationModalSelectorComponent
                                         (outputselectedOrganization)="getOutputOrganization($event)"
                                          [hidden]="selectWorkPackageVisible"></op-organization-modal-selector>
      </div>
      <div style="padding-top: 20px">
        <button *ngIf="!workPackageIsMatched"
          mat-raised-button type="button" color = "primary" (click) = "selectOrCreateWorkPackage()">
          Продолжить
        </button>
      </div>
      <div style="padding-top: 20px; padding-left: 20px">
        <span>{{ workPackageResultText }}</span>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="secondFormGroup">
    <form [formGroup]="secondFormGroup">
      <ng-template matStepLabel>Загрузка финансового обеспечения</ng-template>
      <mat-spinner *ngIf="secondSpinnerVisible" [diameter]="30"></mat-spinner>
      <mat-form-field style="width: 500px; margin-right: 10px" *ngIf="selectedCostObject">
        <mat-label>Бюджет</mat-label>
        <input matInput readonly [value]="selectedCostObject.subject" style="background-color: transparent">
        <button mat-icon-button matSuffix (click)="openCostObject($event)">
          <i class="button--icon icon-move"></i>
        </button>
      </mat-form-field>
      <div style="padding-top: 20px; padding-left: 20px">
        <span>{{ financeResultText }}</span>
      </div>
    </form >
  </mat-step>
  <mat-step [stepControl]="thirdFormGroup">
    <form [formGroup]="thirdFormGroup">
      <ng-template matStepLabel>Загрузка целевых показателей</ng-template>
      <table mat-table [dataSource]="targetMatches" multiTemplateDataRows class="mat-elevation-z8"
              #targetMatchTable *ngIf="targetTableVisible">
        <ng-container matColumnDef="metaId">
          <th mat-header-cell *matHeaderCellDef>metaId (ЭБ)</th>
          <td mat-cell *matCellDef="let targetMatch">Показатель (metaId: {{targetMatch.purposeCriteria.purposeCriteriaMetaId}})</td>
        </ng-container>
        <ng-container matColumnDef="matched">
          <th mat-header-cell *matHeaderCellDef>Сопоставление</th>
          <td mat-cell *matCellDef="let targetMatch" [style.color]="targetMatch.target ? 'green' : 'red'">{{targetMatch.target ? 'Сопоставлен' : 'НЕ СОПОСТАВЛЕН'}} </td>
        </ng-container>

        <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
        <ng-container matColumnDef="expandedDetail">
          <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
            <div class="target-element-detail"
                 [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
              <op-purpose-criteria-view [purposeCriteria]="element.purposeCriteria"></op-purpose-criteria-view>
              <div class="target-choice">
                <div class="target-choice-item" style="width: 70%">
                  <op-target-modal-selector [selectedTarget]="element.target" [project]="element.project"
                                             (outputselectedTarget)="getOutputTarget($event, element)" target-select
                                             [hidden]="element.createNewTarget" #targetModalSelectorComponent
                                             [hiddenLabel]="true" [disabled]="element.disableTargetChoice"
                                             [excludedTargets]="chosenTargets"></op-target-modal-selector>
                </div>
                <div class="target-choice-item" style="justify-content: center">
                  <button mat-icon-button matSuffix (click)="breakBinding(element)">
                    <i class="button--icon icon-{{element.attachedTarget ? 'link': 'attention'}}"
                       [ngStyle]="{'color': (element.attachedTarget) ? 'green' : 'red'}"></i>
                  </button>
                </div>
              </div>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let element; columns: displayedColumns;"
            class="target-element-row"
            [class.target-expanded-row]="expandedElement === element"
            (click)="expandedElement = expandedElement === element ? null : element">
        </tr>
        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="target-detail-row"></tr>
      </table>
      <mat-spinner *ngIf="thirdSpinnerVisible" [diameter]="30"></mat-spinner>
      <div style="padding-top: 20px">
        <button
          mat-raised-button *ngIf="processTargetBtnVisible" type="button" color = "primary" (click) = "continueProcessTarget()">
          Продолжить загрузку
        </button>
      </div>
      <div style="padding-top: 20px; padding-left: 20px">
        <span>{{ targetResultText }}</span>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="fourthFormGroup">
    <form [formGroup]="fourthFormGroup">
      <ng-template matStepLabel>Загрузка Рисков</ng-template>
      <mat-spinner *ngIf="riskSpinnerVisible" [diameter]="30"></mat-spinner>
      <div style="padding-top: 20px; padding-left: 20px">
        <span>{{ riskResultText }}</span>
      </div>
    </form >
  </mat-step>
</mat-vertical-stepper>
